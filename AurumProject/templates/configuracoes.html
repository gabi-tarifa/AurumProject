<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurações - Aurum</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/configuracoes.css') }}">
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/128/3975/3975233.png" type="image/x-icon">
</head>
<body {%if tema_atual == 'cla'%} class="claro" {%endif%}>

    <header {%if tema_atual == 'cla'%} class="claro" {%endif%}>
<a href = "{{ url_for('starting_page') }}">← {{ _(' Voltar') }}</a>

        <h1>{{ _('Configurações') }}</h1>
        <div></div>
    </header>

    <main>
        <section class="config-section {%if tema_atual == 'cla'%} claro {%endif%}">
            <h2>{{ _('Preferências') }}</h2>
            <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
                <label for="sound">{{ _('Sons') }}</label>
                <input type="checkbox" id="sound" {% if sons %} checked {% endif %}>
            </div>
            <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
                <label for="music">{{ _('Música de fundo') }}</label>
                <input type="checkbox" id="music" {% if musica %} checked {% endif %}>
            </div>
            <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
    <label for="idioma">{{ _('Idioma') }}</label>
    <select {%if tema_atual == 'cla'%} class="claro" {%endif%} id="idioma" data-url="{{ url_for('api_idioma') }}">
        {% for lang in idiomas %}
        {% set sel = 'selected' if lang.code == idioma else '' %}
            <option {%if tema_atual == 'cla'%} class="claro" {%endif%} value="{{ lang.code }}" {{ sel }}>
                {{ lang.name }}
            </option>
        {% endfor %}

    </select>
    </div>
    <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">    
    <label for="tema">{{ _('Tema') }}</label>
    <select {%if tema_atual == 'cla'%} class="claro" {%endif%} id="tema" data-url="{{ url_for('api_tema') }}">
        {% for tema in temas %}
        {% set tem = 'selected' if tema.code == tema_atual else '' %}
            <option {%if tema_atual == 'cla'%} class="claro" {%endif%} value="{{ tema.code }}" {{ tem }}>
                {{ tema.name }}
            </option>
        {% endfor %}

    </select>
    </div>
        </section>

<section class="config-section {%if tema_atual == 'cla'%} claro {%endif%}">
    <h2>{{ _('Conta') }}</h2>

    <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
        <label>{{ _('Alterar Apelido') }}</label>
        <button onclick="abrirDiv('painel-apelido')">{{ _('Editar') }}</button>
    </div>
    <div id="painel-apelido" class="painel-edicao oculto {%if tema_atual == 'cla'%} claro {%endif%}">
        <form onsubmit="salvarApelido(); return false;">
            <h2>{{ _('Alterar Apelido') }}</h2>
            <label for="novo-apelido">{{ _('Novo Apelido:') }}</label>
            <input type="text" id="novo-apelido" name="novo-apelido" placeholder="{{ _('Digite o novo apelido') }}" value="{{ usuario.nome }}" required>
            
            <div class="botoes">
                <button class="selecionar" type="submit">{{ _('Salvar') }}</button>
                <button class="selecionar" type="button" onclick="fecharDiv('painel-apelido')">{{ _('Cancelar') }}</button>
            </div>
        </form>
    </div>

    <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
        <label>{{ _('Alterar Email Cadastrado') }}</label>
        <button onclick="abrirDiv('painel-email')">{{ _('Editar') }}</button>
    </div>
    <div id="painel-email" class="painel-edicao oculto {%if tema_atual == 'cla'%} claro {%endif%}">
        <form onsubmit="salvarEmail(); return false;">
            <h2>{{ _('Alterar Email') }}</h2>
            <label for="novo-email">{{ _('Novo Email:') }}</label>
            <input type="email" id="novo-email" name="novo-email" placeholder="{{ _('Digite o novo email') }}" value="{{ usuario.email }}" required>
            
            <div class="botoes">
                <button class="selecionar" type="submit">{{ _('Salvar') }}</button>
                <button class="selecionar" type="button" onclick="fecharDiv('painel-email')">{{ _('Cancelar') }}</button>
            </div>
        </form>
    </div>

    <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
        <label>{{ _('Alterar Senha') }}</label>
        <button onclick="abrirDiv('painel-senha')">{{ _('Editar') }}</button>
    </div>
    <div id="painel-senha" class="painel-edicao oculto {%if tema_atual == 'cla'%} claro {%endif%}">
        <form onsubmit="salvarSenha(); return false;">
            <h2>{{ _('Alterar Senha') }}</h2>
            <label for="senha-atual">{{ _('Senha Atual:') }}</label>
            <input type="password" id="senha-atual" name="senha-atual" required><br>

            <label for="nova-senha">{{ _('Nova Senha:') }}</label>
            <input type="password" id="nova-senha" name="nova-senha" required><br>

            <label for="confirmar-senha">{{ _('Confirmar Nova Senha:') }}</label>
            <input type="password" id="confirmar-senha" name="confirmar-senha" required>
            
            <span id="textoerro" class="textoerro"></span><br>
            
            <div class="botoes">
                <button class="selecionar" type="submit">{{ _('Salvar') }}</button>
                <button class="selecionar" type="button" onclick="fecharDiv('painel-senha')">{{ _('Cancelar') }}</button>
            </div>
        </form>
    </div>
</section>

        <section class="config-section {%if tema_atual == 'cla'%} claro {%endif%}">
            <h2>{{ _('Aplicativo') }}</h2>
            <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
                <label>{{ _('Versão do App') }}</label>
                <span>0.3.3.1.1 Beta</span>
            </div>
            <div class="config-item {%if tema_atual == 'cla'%} claro {%endif%}">
                <label>{{ _('Redefinir configurações') }}</label>
                <button onclick="resetarConfig()">{{ _('Resetar') }}</button>
            </div>
        </section>
    </main><script>
  // valor inicial vindo do backend, só na primeira vez
  const sonsIniciais = {{ 'true' if sons_ativos else 'false' }};
  // se já tiver no localStorage, usa ele; senão, define o inicial
  if (localStorage.getItem('sons_ativos') === null) {
    localStorage.setItem('sons_ativos', sonsIniciais ? 'true' : 'false');
  }
  window.SONS_ATIVOS = localStorage.getItem('sons_ativos') == 'true';
</script>
    <script src="{{ url_for('static', filename='js/sounds.js') }}"></script>
    <script src="{{ url_for('static', filename='js/configuracoes.js') }}"></script>

</body>
</html>